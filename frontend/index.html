<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MahaSheti App Dashboard</title>
    
<style>
    /* 1. Global Reset and Base Styles */
    body { 
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
        margin: 0; 
        padding: 0;
        background-color: #f0f8f0; /* Very light green background */
        color: #333;
        line-height: 1.6;
    }
    .container { 
        width: 95%;
        max-width: 1200px; 
        margin: 20px auto; 
        background: white; 
        padding: 30px; 
        border-radius: 12px; 
        box-shadow: 0 8px 16px rgba(0,0,0,0.1); 
    }
    h1 { 
        color: #1e8449; /* Darker green */
        border-bottom: 4px solid #2ecc71; /* Accent line */
        padding-bottom: 15px; 
        margin-bottom: 30px;
        font-size: 2em;
    }
    
    /* 2. Controls - Responsive Flex Layout */
    .controls {
        margin-bottom: 30px;
        display: flex;
        gap: 15px;
        flex-wrap: wrap; /* Allows buttons to wrap on smaller screens */
        justify-content: flex-start;
    }
    .controls button { 
        padding: 12px 20px; 
        background-color: #3498db; /* Blue for primary actions */
        color: white; 
        border: none; 
        border-radius: 8px; 
        cursor: pointer; 
        font-size: 1em;
        font-weight: bold;
        transition: background-color 0.3s, transform 0.2s; 
        flex-grow: 1; /* Allows buttons to expand */
        min-width: 150px; /* Minimum width for readability */
    }
    .controls button:hover { 
        background-color: #2980b9; 
        transform: translateY(-3px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }
    
    /* 3. Table Styling - Responsive */
    #data-display { 
        margin-top: 25px; 
        overflow-x: auto; /* Ensures horizontal scrolling for tables on mobile */
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        padding: 5px; /* Padding for the scroll area */
    }
    table { 
        width: 100%; 
        min-width: 600px; /* Ensures table columns don't collapse too much */
        border-collapse: collapse; 
    }
    th, td { 
        border: 1px solid #e0e0e0; 
        padding: 15px 12px; 
        text-align: left; 
        font-size: 0.95em;
    }
    th { 
        background-color: #2ecc71; 
        color: white; 
        text-transform: uppercase;
        font-weight: 600;
        position: sticky; /* Keeps header visible during vertical scroll */
        top: 0;
    }
    tr:nth-child(even) {
        background-color: #f5fcf5; /* Lightest green for striping */
    }
    
    /* 4. Utility Classes */
    .loading, .error {
        text-align: center;
        padding: 30px;
        border-radius: 5px;
        font-size: 1.1em;
    }
    .loading { color: #3498db; }
    .error { 
        background-color: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
    }

    /* 5. Media Queries for Mobile Responsiveness */
    @media (max-width: 768px) {
        .container {
            padding: 20px;
            margin: 10px auto;
        }
        h1 {
            font-size: 1.7em;
            text-align: center;
        }
        .controls {
            flex-direction: column; /* Stack buttons vertically */
            gap: 10px;
        }
        .controls button {
            width: 100%; /* Full width for better tapping */
            min-width: auto;
        }
        th, td {
            padding: 10px 8px; /* Reduce padding on small screens */
            font-size: 0.9em;
        }
        table {
            min-width: 500px; /* Keep minimum width to force scrolling */
        }
    }

    @media (max-width: 480px) {
        body { padding: 5px; }
        .container { padding: 15px; }
        h1 { font-size: 1.5em; }
    }
</style>
</head>
<body>
    <div class="container">
        <h1>üå± ‡§Æ‡§π‡§æ‡§∂‡•á‡§§‡•Ä ‡•≤‡§™</h1>
        

        <div class="controls">
            <button onclick="fetchData('crops')">‡§™‡§ø‡§ï‡§æ‡§Ç‡§ö‡•Ä ‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä (Crops)</button>
            <button onclick="fetchData('rates')">‡§¨‡§æ‡§ú‡§æ‡§∞ ‡§¶‡§∞ (Rates)</button>
            <button onclick="fetchData('schemes')">‡§∂‡§æ‡§∏‡§ï‡•Ä‡§Ø ‡§Ø‡•ã‡§ú‡§®‡§æ (Schemes)</button>
        </div>

        <div id="data-display">
            ‡§µ‡§∞‡•Ä‡§≤ ‡§¨‡§ü‡§£ ‡§¶‡§æ‡§¨‡•Ç‡§® ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§ï‡§∞‡§æ.
        </div>
    </div>

    <script>
        const API_BASE_URL = "https://mahashetiapp-backend.onrender.com";
        const dataDisplay = document.getElementById('data-display');

        /**
         * ‡§Æ‡§ø‡§≥‡§æ‡§≤‡•á‡§≤‡•ç‡§Ø‡§æ JSON ‡§°‡•á‡§ü‡§æ‡§ö‡•á HTML ‡§ü‡•á‡§¨‡§≤‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§∞‡•Ç‡§™‡§æ‡§Ç‡§§‡§∞‡§£ ‡§ï‡§∞‡§§‡•á.
         * @param {Array} data - API ‡§ï‡§°‡•Ç‡§® ‡§Æ‡§ø‡§≥‡§æ‡§≤‡•á‡§≤‡§æ ‡§°‡•á‡§ü‡§æ 
         * @param {string} title - ‡§ü‡•á‡§¨‡§≤‡§ö‡•á ‡§∂‡•Ä‡§∞‡•ç‡§∑‡§ï 
         */
        function renderTable(data, title) {
            if (!data || data.length === 0) {
                return `<p><strong>${title}:</strong> ‡§°‡•á‡§ü‡§æ‡§¨‡•á‡§∏‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§ï‡•ã‡§£‡§§‡•Ä‡§π‡•Ä ‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§æ‡§π‡•Ä.</p>`;
            }

            // ‡§ü‡•á‡§¨‡§≤ ‡§π‡•á‡§°‡§∞ (Headers)
            const headers = Object.keys(data[0]);
            
            let html = `<h2>${title} (${data.length} ‡§®‡•ã‡§Ç‡§¶‡•Ä)</h2>`;
            html += '<table><thead><tr>';
            
            headers.forEach(header => {
                html += `<th>${header}</th>`;
            });
            html += '</tr></thead><tbody>';

            // ‡§ü‡•á‡§¨‡§≤ ‡§¨‡•â‡§°‡•Ä (Rows)
            data.forEach(item => {
                html += '<tr>';
                headers.forEach(header => {
                    const value = item[header] === null || item[header] === undefined ? '' : item[header];
                    html += `<td>${value}</td>`;
                });
                html += '</tr>';
            });

            html += '</tbody></table>';
            return html;
        }

        /**
         * ‡§®‡§ø‡§µ‡§°‡§≤‡•á‡§≤‡•ç‡§Ø‡§æ API ‡§è‡§Ç‡§°‡§™‡•â‡§á‡§Ç‡§ü‡§µ‡§∞‡•Ç‡§® ‡§°‡•á‡§ü‡§æ ‡§´‡•á‡§ö ‡§ï‡§∞‡§§‡•á.
         * @param {string} endpoint - API ‡§ö‡§æ ‡§∂‡•á‡§µ‡§ü‡§ö‡§æ ‡§≠‡§æ‡§ó (‡§â‡§¶‡§æ. 'crops', 'rates')
         */
        async function fetchData(endpoint) {
            dataDisplay.innerHTML = '<div class="loading">‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä ‡§≤‡•ã‡§° ‡§ï‡§∞‡§§ ‡§Ü‡§π‡•á...</div>';
            const url = `${API_BASE_URL}/api/${endpoint}`;
            let title = '';

            switch(endpoint) {
                case 'crops': title = '‡§™‡§ø‡§ï‡§æ‡§Ç‡§ö‡•Ä ‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä'; break;
                case 'rates': title = '‡§¨‡§æ‡§ú‡§æ‡§∞ ‡§¶‡§∞'; break;
                case 'schemes': title = '‡§∂‡§æ‡§∏‡§ï‡•Ä‡§Ø ‡§Ø‡•ã‡§ú‡§®‡§æ'; break;
                default: title = '‡§°‡•á‡§ü‡§æ';
            }

            try {
                const response = await fetch(url);
                
                // HTTP 4xx ‡§ï‡§ø‡§Ç‡§µ‡§æ 5xx ‡§§‡•ç‡§∞‡•Å‡§ü‡•Ä‡§Ç‡§∏‡§æ‡§†‡•Ä
                if (!response.ok) {
                    const errorDetails = await response.json().catch(() => ({}));
                    const errorMessage = errorDetails.message || `API ‡§ï‡§°‡•Ç‡§® ‡§§‡•ç‡§∞‡•Å‡§ü‡•Ä ‡§Æ‡§ø‡§≥‡§æ‡§≤‡•Ä: ${response.status}`;
                    throw new Error(errorMessage);
                }
                
                const data = await response.json();
                
                // ‡§°‡•á‡§ü‡§æ ‡§Æ‡§ø‡§≥‡§æ‡§≤‡•ç‡§Ø‡§æ‡§µ‡§∞ ‡§§‡•ã ‡§ü‡•á‡§¨‡§≤‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§ø‡§§ ‡§ï‡§∞‡§æ
                dataDisplay.innerHTML = renderTable(data, title);

            } catch (error) {
                dataDisplay.innerHTML = `<div class="error">
                    <p><strong>‡§°‡•á‡§ü‡§æ ‡§´‡•á‡§ö ‡§ï‡§∞‡§§‡§æ‡§®‡§æ ‡§§‡•ç‡§∞‡•Å‡§ü‡•Ä:</strong> ${error.message}</p>
                    <p>‡§∏‡•Ç‡§ö‡§®‡§æ: ‡§ï‡•É‡§™‡§Ø‡§æ ‡§¨‡•Ö‡§ï‡§è‡§Ç‡§° ‡§ú‡§æ‡§ó‡•á ‡§π‡•ã‡§£‡•ç‡§Ø‡§æ‡§ö‡•Ä (Wake up) ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§ï‡§∞‡§æ. <br> 
                    <a href="${API_BASE_URL}/api/crops" target="_blank" style="color: #721c24; font-weight: bold;">‡§Ø‡•á‡§•‡•á ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•Ç‡§® ‡§∏‡•ç‡§ü‡•á‡§ü‡§∏ ‡§§‡§™‡§æ‡§∏‡§æ</a></p>
                </div>`;
                console.error('Fetch Error:', error);
            }
        }
        
        // ‡§™‡•á‡§ú ‡§≤‡•ã‡§° ‡§ù‡§æ‡§≤‡•ç‡§Ø‡§æ‡§µ‡§∞ ‡§°‡§ø‡§´‡•â‡§≤‡•ç‡§ü 'crops' ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§ï‡§∞‡§æ
        document.addEventListener('DOMContentLoaded', () => {
            fetchData('crops');
        });
    </script>
</body>
</html>